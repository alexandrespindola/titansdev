import{d as R,r as d,p,a2 as D,z as nn,L as en}from"./DOJuQvem.js";import{g as on,a as tn,b as an,U as un}from"./D8xv3Zp9.js";const dn=R({__name:"CldUploadWidget",props:{onClose:{type:Function},onError:{type:Function},onOpen:{type:Function},onUpload:{type:Function},onAbort:{type:Function},onBatchCancelled:{type:Function},onDisplayChanged:{type:Function},onPublicId:{type:Function},onQueuesEnd:{type:Function},onQueuesStart:{type:Function},onRetry:{type:Function},onShowCompleted:{type:Function},onSourceChanged:{type:Function},onSuccess:{type:Function},onTags:{type:Function},onUploadAdded:{type:Function},options:{},signatureEndpoint:{},uploadPreset:{},config:{},tags:{}},setup(M){var k;function T(n){return window&&"requestIdleCallback"in window?requestIdleCallback(n):setTimeout(()=>n(),1)}const a=M,{onClose:y,onError:r,onOpen:v,onUpload:h,options:m,signatureEndpoint:w,uploadPreset:z,onAbort:L,onBatchCancelled:q,onDisplayChanged:K,onPublicId:Q,onQueuesEnd:$,onQueuesStart:N,onRetry:B,onShowCompleted:j,onSourceChanged:x,onSuccess:G,onTags:H,onUploadAdded:V,config:J}=a,l=d(),e=d(),s=d(),u=d(),C=d(!0),f={close:F,destroy:S,hide:E,isDestroyed:U,isMinimized:O,isShowing:A,minimize:_,open:W,show:I,update:P,abort:L,"batch-cancelled":q,"display-changed":K,publicid:Q,"queues-end":$,"queues-start":N,retry:B,"show-completed":j,"source-changed":x,success:G,tags:H,"upload-added":V},X=w&&tn({signatureEndpoint:String(w),fetch}),g=on({uploadPreset:z||p().public.cloudinary.uploadPreset,apiKey:p().public.cloudinary.apiKey,uploadSignature:X,...m},{cloud:{cloudName:p().public.cloudinary.cloudName,apiKey:p().public.cloudinary.apiKey},...m,...f,...J}),Y=an({onError:n=>{s.value=n,typeof r=="function"&&r(n,{widget:e.value.current,...f})},onResult:n=>{if(typeof(n==null?void 0:n.event)!="string")return;u.value=n;const t=un[n.event];if(typeof t=="string"&&typeof a[t]=="function"){const c=a[t];c(n,{widget:e.value.current,...f})}const i=`${t}Action`;if(i&&typeof a[i]=="function"){const c=a[i];c(n)}}});(k=a.tags)!=null&&k.length&&(g.showAdvancedOptions=!0,g.getTags=(n,t)=>{var i;return n(t?(i=a.tags)==null?void 0:i.filter(c=>!c.indexOf(t)):a.tags)}),D(u,()=>{var i,c;if(typeof u.value>"u")return;const n=((i=u.value)==null?void 0:i.event)==="success",t=((c=u.value)==null?void 0:c.event)==="display-changed"&&u.value.info==="hidden";n&&typeof h=="function"&&h(u,e.value),t&&typeof y=="function"&&y(e.value)}),D(s,()=>{s.value&&typeof r=="function"&&r(s,e.value)});function Z(){C.value=!1,l.value||(l.value=window.cloudinary),T(()=>{e.value||(e.value=b())})}function b(){return l.value.createUploadWidget(g,Y)}function o(n){e.value||(e.value=b()),typeof(e==null?void 0:e.value[n])=="function"&&e.value[n]()}function F(){o("close")}function S(){o("destroy")}function E(){o("hide")}function U(){o("isDestroyed")}function O(){o("isMinimized")}function A(){o("isShowing")}function _(){o("minimize")}function I(){o("show")}function P(){o("update")}function W(){o("open"),typeof v=="function"&&v(e.value)}return nn({script:[{id:`cloudinary-uploadwidget-${Math.floor(Math.random()*100)}`,src:"https://widget.cloudinary.com/v2.0/global/all.js",onload:Z,onerror:n=>console.error(`Failed to load Cloudinary Upload Widget: ${n.message}`)}]}),(n,t)=>en(n.$slots,"default",{cloudinary:l.value,widget:e.value,open:W,update:P,show:I,isShowing:A,isMinimized:O,isDestroyed:U,destroy:S,close:F,hide:E,minimize:_,results:u.value,error:s.value,isLoading:C.value})}});export{dn as _};
